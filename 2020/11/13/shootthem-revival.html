<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="/blog2-ssr/images/favicon-compressed.webp">
    <link rel="shortcut icon" href="/blog2-ssr/images/favicon-compressed.webp">
    <link rel="apple-touch-icon" href="/blog2-ssr/images/favicon-compressed.webp">

    <link rel="stylesheet" href="/blog2-ssr/shared.css">
    <link rel="stylesheet" href="/blog2-ssr/prism.css">

    <title>ShootThem! revival</title></head>
<body class="svelte-1gr3n62"><style>:root{--left-side:200px;--right-side:200px;--nav-height:64px;--background-color:#FFD166;--primary-color:#06D6A0;--primary-accent-color:#049F76;--secondary-color:#118AB2;--sub-color:#073B4C;--nav-background:#fff;--article-background:#fff
    }body.svelte-1gr3n62.svelte-1gr3n62{padding:0;margin:0;color:var(--sub-color);background:var(--background-color);font-family:Roboto, "Helvetica Neue", Arial, sans-serif;font-size:18px;display:grid;grid-template:var(--nav-height) auto var(--nav-height)/var(--left-side) calc(100% - var(--left-side) - var(--right-side)) var(--right-side)
    }nav.top.svelte-1gr3n62 .links.svelte-1gr3n62{grid-area:1/2/2/3;display:flex;align-items:center
    }nav.top.svelte-1gr3n62 .links a.svelte-1gr3n62{margin-right:1em
    }a.svelte-1gr3n62.svelte-1gr3n62{color:var(--secondary-color);text-decoration:none
    }a.svelte-1gr3n62.svelte-1gr3n62:hover,a.svelte-1gr3n62.svelte-1gr3n62:active{color:var(--sub-color)
    }footer.svelte-1gr3n62.svelte-1gr3n62{grid-area:3/1/4/4;background:#fff;display:inline-grid;grid-template:100%/var(--left-side) auto var(--right-side)
    }nav.top.svelte-1gr3n62.svelte-1gr3n62{background-color:var(--nav-background);display:inline-grid;grid-template:100%/var(--left-side) auto var(--right-side);grid-area:1/1/2/4
    }main.svelte-1gr3n62.svelte-1gr3n62{grid-area:2/2/3/3;margin-top:1em;display:flex;flex-direction:column
    }@media screen and (max-width: 1340px){:root{--left-side:0px;--right-side:0px
        }body.svelte-1gr3n62.svelte-1gr3n62{background:var(--background-color)
        }nav.top.svelte-1gr3n62 .links.svelte-1gr3n62{justify-content:space-around
        }}
.btn.svelte-7idbpu{display:inline-flex;font-size:18px;color:#fff;background:var(--primary-color);padding:10px;border-radius:8px
    }.btn.svelte-7idbpu:hover{background:var(--primary-accent-color);color:#fff
    }</style>

    <nav class="top svelte-1gr3n62">
            <div class="links svelte-1gr3n62"><a class="nav-link nav-item svelte-1gr3n62" href="/blog2-ssr/">Home</a>
                <a class="nav-link nav-item svelte-1gr3n62" href="/blog2-ssr/about/">About</a></div>
        </nav>

    <main class="svelte-1gr3n62"><article><h1>ShootThem! revival</h1>

    <time>13 Nov 2020 at 02:46</time>

    <div class="content"><p>Quite some time ago I <a href="tumblr/2015-04-06-shootthem">dag out</a> the sources of an old game of mine, ShootThem! made back when I was at high-school, around 2006.</p>
<p>It has been over a decade ever since I made that game and I had enough inspiration to revisit the code once again.</p>
<p>This is a short update blog about what it used to be and what it became as of now.</p>
<div><LazyImg src="/images/shootthem-revival/ShootThem 15_09_2020 8_19_43 AM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 26_09_2020 8_19_43 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/square1_render2.webp" /></div>

<!--more-->

<h2 id="2006">2006</h2>
<p>Back in 2006 I have barely learned some OOP and C / C++, just enough to be able to use it in school programming competitions.</p>
<p>The game looked awful - there were no textures in the whole game, the models were mostly hand-made by myself in some dodgy 3D editor
(Calligra TrueSpace or something alike).</p>
<div><LazyImg src="/images/shootthem-revival/ShootThem 13_09_2020 10_18_45 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 13_09_2020 10_18_52 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 15_09_2020 8_19_36 AM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 15_09_2020 8_19_43 AM.webp" /></div>

<p>The code was terrible as well - static variables, huge functions, not to mention the whole game was a huge hard-coded, non-configurable mess in one <code>main.cpp</code> file.</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-11-13 at 2.02.28 pm.webp" /></div>

<p>But there was also a map editor, which allowed for some customization - it was basically a first-person camera and few magical buttons that allowed to define target positions for a specific level. The level mesh and output file were both provided via command-line arguments.</p>
<h2 id="2015">2015</h2>
<p>I have dag out the sources and decided to put them on GitHub for historical reference. I have also managed to set up CMake for the thing
so that it could be built on <em>any</em> computer without bothering too much about magical compiler options and everything.</p>
<h2 id="2020">2020</h2>
<p>I have started the rework. First things first, I reworked the CMake configuration to a modern style and replaced the dependency “management” (essentially an instruction to manually unzip Irrlich and IrrKlang files and put them in specific directories) with CMake’s <code>Fetch</code> module.</p>
<p>Then I thought about reshaping the code, so I have split one big <code>main.cpp</code> file with static variables and a handful of functions into classes, encapsulating the logic - <code>Level</code>, <code>Score</code>, <code>PlayerState</code>, <code>GameState</code>. This allowed me to maintain the working state of the game whilst actually improving the state of the code (<a href="https://github.com/shybovycha/shoot-them/commit/b49b478e76c33fd59c5b1960127b21a1039fce9a">commit</a>).</p>
<p>I have also extracted the settings into a separate file, <code>settings.xml</code> so that the application can be actually somewhat configured. Also, the magical data format for the levels was replaced with much more readable XML, <code>levels.xml</code>:</p>
<pre><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>levels</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>model</span><span class="token punctuation">></span></span>room1.dae<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>model</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entities</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>light</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>position</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-717.96405029296875<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>129.1875<span class="token punctuation">"</span></span> <span class="token attr-name">z</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>light</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>light</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>position</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>125.34170532226563<span class="token punctuation">"</span></span> <span class="token attr-name">z</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>258.18295288085938<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>light</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>position</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>-765.06158447265625<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>271.0589599609375<span class="token punctuation">"</span></span> <span class="token attr-name">z</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>670.49334716796875<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>
      <span class="token comment">&lt;!-- ... --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entities</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>levels</span><span class="token punctuation">></span></span>
</code></pre>
<p>Next step was to reduce the coupling of code components and introduce some sort of state management. I am still unhappy with what I ended up with, but it is still infinitely better than one single <code>main()</code> function.</p>
<p>I have ended up with something similar to Redux from front-end world (at least that was an initial plan) - there is a <em>Store</em>, where the state is stored; there are <em>Actions</em>, which define a change to the state; there is a <em>Reducer</em>, which modifies the state of the app; and finally, there are <em>Subscribers</em> which react to state changes and render the state of the app.</p>
<p>But the issue was that there are many <em>effects</em> to handle like playing sound, loading and unloading the data, etc.</p>
<p>Along the way I have also kept maintaining a list of things I was thinking about - bugs found, improvements, refactoring ideas, etc (<a href="https://github.com/shybovycha/shoot-them/commits/master/README.md">README.md history</a>).</p>
<p>Few improvements included adding a main menu, replacing the “UI” with something more user-friendly (previously it was just an ugly line of text), improving the “drunk shooter” effect (ended up replacing it with shaders, which is not a trivial task in Irrlicht - more on that later).</p>
<div><LazyImg src="/images/shootthem-revival/ShootThem 20_09_2020 2_48_59 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 26_09_2020 8_19_43 PM.webp" /></div>

<p>I have also started reworking the 3D models for the game and decided it was a good point to just show how I <em>meant</em> the original art to be in the game:</p>
<div><LazyImg src="/images/shootthem-revival/egypt1_render.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/forest1_render.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/square1_render2.webp" /></div>

<p>The art is still far from being ready, but here’s a preview of the new training level:</p>
<div><LazyImg src="/images/shootthem-revival/blender_shooting_range3.webp" /></div>

<p>The editor was also reworked… Or better being said, made from scratch - now it actually has a GUI, it allows to manage all the levels without restarting the app, it allows to place targets and move them around, it allows to place light sources on the scene and it is not a first-person camera anymore.</p>
<div><LazyImg src="/images/shootthem-revival/Shoot Them Editor 26_09_2020 1_09_03 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/Shoot Them Editor 26_09_2020 1_12_56 PM.webp" /></div>

<h2 id="lessons-learned">Lessons learned</h2>
<p>There are quite a few lessons that I have learned.</p>
<h3 id="cmake-sucks-a-lot">CMake sucks. A lot.</h3>
<p>I freaking hate CMake for a few very good reasons:</p>
<ul>
<li>awful syntax, it is still same good old Make, just with syntax being wrecked</li>
<li>lack of any structure to the projects - everyone does it in their own preferred way, so no one will actually tell you <em>the way</em> to set up your project</li>
<li>the lack of dependency managemen - which, in 2020, seems like a huge drawback, especially if you don’t develop every single bit of your application from scratch</li>
<li>performance - yes, performance - by default it performs a clean build every time - it compiles <em>everything</em> from scratch every time you change anything</li>
<li>documentation - no one will tell you <em>the way to do it</em>; most manuals and articles still rely on CMake 2.6 or 3.0 at best; a lot of information online is so dispersed, inconsistent and out-of-date - you will be surprised!</li>
</ul>
<p>The only reason I use CMake is because all the dependencies I use <em>could</em> be used with CMake. Well, except Irrlicht and IrrKlang.</p>
<p>I thought Bazel or Buck will be better, but they still require one to create custom build instructions for those dependencies and it is especially hard for a cross-platform libraries such as Irrlicht. Well, at least they do solve most of CMake issues I have listed above.</p>
<h3 id="irrlicht-is-old">Irrlicht is old</h3>
<p>It is <em>extremely</em> old - last <em>bugfix</em> version, <code>1.8.4</code>, was released on <code>9th July 2016</code> (which is only 4.5 years ago as of now) and the corresponding minor version, <code>1.8.0</code> being released on <code>8th November 2012</code> (8 years ago as of now).</p>
<p>It might not seem like a <em>huge</em> deal, but here are few things that I have noticed:</p>
<ul>
<li>shaders are hard to get working</li>
<li>only GLSL and HSL are supported</li>
<li>no frame buffer support</li>
<li>renderers are OpenGL 3 and DirectX 9</li>
<li>out-of-the-box tools are quite limited:<ul>
<li>camera movement is either Maya-style, First-Person-Shooter-style or manual control, through matrices and vectors</li>
<li>the GUI out of the box is not suited for high-resolution monitors with fonts being pixelated</li>
<li>overall a lot of bugs with GUI (random events missed or fired)</li>
</ul>
</li>
<li>ray-picking is buggy</li>
<li>textures / lighting is buggy as heck (sometimes textures are disappearing, separate mesh triangles being shaded differently from others, etc.)</li>
<li>anti-aliasing not working properly for sprites (which makes my HUD look ugly most of the time, even though it is high-res images)</li>
</ul>
<p>Check these screenshots for example:</p>
<div><LazyImg src="/images/shootthem-revival/ShootThem 26_09_2020 8_19_30 PM.webp" /></div>
<div><LazyImg src="/images/shootthem-revival/ShootThem 26_09_2020 8_19_43 PM.webp" /></div>

<p>It is the same scene, with lighting being messed up for <em>all target models</em> on the latter screenshot.</p>
<p>With the subset of APIs that are needed for my game, I am quite seriously considering just sticking to lower-level graphics APIs (OpenGL / DirectX) and stepping away from Irrlicht.</p>
<h3 id="c-is-not-easy">C++ is not easy</h3>
<p>With the idea of having redux-like state management and the strong type system of C++ I thought it would be a good idea to leverage the compiler and language features to do some compile-time checks for the actions that are being dispatched. I started with templates, but then figured out (the most painful way possible) that templates are merely hints for compiler.</p>
<p>Also, one can not define method overrides for the base class of the hierarchy by specifying child class as method param.</p>
<p>So my initial design like below fell apart very quickly:</p>
<pre><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">BaseAction</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PlaySoundAction</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BaseAction</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>string filename<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DestroyEntityAction</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BaseAction</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>shared_ptr<span class="token operator">&lt;</span>Entity<span class="token operator">></span> entity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ---</span>

<span class="token keyword">class</span> <span class="token class-name">BaseReducer</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>BaseAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Reducer</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BaseReducer</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// error: 'processAction' marked 'override' but does not override any member functions</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>DestroyEntityAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// error: 'processAction' marked 'override' but does not override any member functions</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>PlaySoundAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ---</span>

<span class="token keyword">class</span> <span class="token class-name">Store</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>BaseReducer<span class="token operator">></span> reducer<span class="token punctuation">;</span>
    std<span class="token double-colon punctuation">::</span>queue<span class="token operator">&lt;</span>BaseAction<span class="token operator">*</span><span class="token operator">></span> actionQueue<span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">processQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>actionQueue<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">auto</span> action <span class="token operator">=</span> actionQueue<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        actionQueue<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// error: no matching member function for call to 'processAction'</span>
        reducer<span class="token operator">-></span><span class="token function">processAction</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Templates won’t solve the issue either:</p>
<pre><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">BaseReducer</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// only this method will be called every time</span>
    <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span>
    <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>T action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"processing unknown action"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Reducer</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BaseReducer</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>DestroyEntityAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">BaseReducer</span><span class="token double-colon punctuation">::</span><span class="token function">processAction</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destroying an object"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>PlaySoundAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">BaseReducer</span><span class="token double-colon punctuation">::</span><span class="token function">processAction</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
      std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"playing a sound"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Also, a template method can’t be virtual.</p>
<p>So here comes another trick front-end developers use, the <code>type</code> field for actions and <code>switch..case</code> statement in reducer:</p>
<pre><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">BaseReducer</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>BaseAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Reducer</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BaseReducer</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">processAction</span><span class="token punctuation">(</span>BaseAction<span class="token operator">*</span> action<span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token operator">-></span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> ActionType<span class="token double-colon punctuation">::</span>PLAY_SOUND<span class="token operator">:</span>
          std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"playing a sound"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token keyword">case</span> ActionType<span class="token double-colon punctuation">::</span>DESTROY_ENTITY<span class="token operator">:</span>
          std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destroying an object"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>

        <span class="token keyword">default</span><span class="token operator">:</span>
          std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"unknown action"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="editor-is-really-important">Editor is really important</h3>
<p>My game has multiple levels. Each level requires its own lighting and target placement. It is quite hard to do properly without the editor.
And the first version of my “editor” has proven that.</p>
<p>Even the new version of editor lacks lots of features - one still can’t rotate the targets or see the actual targets, there are no particle emitters available, there are no scene-specific events that would have allowed some neat mechanics.</p>
<p>And finally, it is hard to see the result in the editor itself - there will be differences with the game.</p>
<p>However, I did consider using GoDot engine for the game.</p>
<p>There are features that I really liked about it.</p>
<h4 id="i18n-support">I18n support</h4>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.58.10 am.webp" /></div>

<h4 id="configurable-user-actions">Configurable user actions</h4>
<p>This way you can have same handler for gamepad buttons’ and keyboard/mouse input events:</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.57.58 am.webp" /></div>

<h4 id="attaching-scripts-to-any-object-on-the-scene">Attaching scripts to any object on the scene</h4>
<p>This allows for a magnitude of interesting mechanics.</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.55.19 am.webp" /></div>

<p>For a number of reasons I didn’t choose it - there were some user experience issues significantly reducing my productivity.</p>
<h4 id="asset-management">Asset management</h4>
<p>Sspecifically the neccesity to specify every single texture for every single object on a scene. Check out this chicken model:</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.55.34 am.webp" /></div>

<p>It is just an OBJ file with every material specified:</p>
<pre><code>mtllib chicken.mtl

# 262 vertex positions
v  18.556948 41.779099 -12.354659
v  20.53804 50.283123 -13.547608

# ...

# Mesh &#39;0&#39; with 68 faces
g 0
usemtl Material #1
f  1/1/1 2/2/2 3/3/3
f  3/3/3 2/2/2 4/4/4

# ...
</code></pre>
<p>Yet in the editor you’ll have to manually assign every single material to every single sub-mesh:</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.56.56 am.webp" /></div>

<h4 id="not-really-clear-scene-node-types">Not really clear scene node types</h4>
<p>Now which node do I use for kinematic physical body?</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 10.10.15 am.webp" /></div>

<p>Just what the heck is “spatial” and why does it have both “camera” and “collision shape” next to “audio stream”?</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 10.10.20 am.webp" /></div>

<h4 id="lack-of-any-sort-of-pre-made-solutions">Lack of any sort of pre-made solutions</h4>
<p>So that every time you need an FPS camera - you have to define it from zero, using the matrix transformations. This increases the amount of boilerplate code and actually reduces the productivity even compared to Irrlicht:</p>
<div><LazyImg src="/images/shootthem-revival/Screen Shot 2020-08-26 at 9.55.19 am.webp" /></div>

<h2 id="this-is-not-the-end">This is not the end</h2>
<p>I am not done with this project revival just yet - I still want it to build under OSX and I still have few assets to put into the game.
Also, the plot is still not very clear, so I’d better come up with something rather interesting.
Stay tuned for more updates!</p>
</div>
</article></main>

    

    <script src="/blog2-ssr/lazyLoadImages.js"></script></body>
</html>